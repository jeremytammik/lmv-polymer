<link rel="import" href="../../bower_components/polymer/polymer.html">

<!--
  Dependent on properties list having "label" as the name at first position in list
 -->

<polymer-element name="lmv-property-view" attributes="properties">
  <template>
    <link rel="stylesheet" href="lmv-property-view.css">

    <template repeat="{{cat in keys(categories)}}">
      <div class="category">{{cat}}</div>
      <table>
        <template repeat="{{prop in categories[cat]}}">
          <template if="{{prop.displayName!='label'}}">
            <tr>
              <td class="prop">{{prop.displayName}}</td>
              <td class="prop">{{prop.displayValue}}</td>
            </tr>
          </template>
        </template>
      </table>
    </template>

  </template>

  <script>
    (function () {
      Polymer({
        propertiesChanged: function() {
          var props = this.properties;

          // grab name of file
          var name = props[0].displayValue;
          this.categories = {};

          for (var i=0; i<props.length; i++) {
            // if no category, goes under generic "name" category
            var cat = props[i].displayCategory || name;

            // if special __category__, disregard
            if (cat.indexOf("__") === 0)
              continue;

            // create new category, if necessary
            if (!this.categories[cat])
              this.categories[cat] = [];

            // add property under category
            this.categories[cat].push(props[i]);
          }
        },
        keys: function(obj) {
          if (obj) return Object.keys(obj);
        }
      });
    })();
  </script>
</polymer-element>
